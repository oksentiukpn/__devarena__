{% extends "base.html" %}

{% block title %}Sign up - DevArena{% endblock %}

{% block extra_styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='sign_up.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="main-container">
    <div class="logo-section">
        <div class="logo-wrapper">
            <svg class="logo-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <title>DevArena Logo</title>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
            </svg>
            <span class="logo-text">DevArena</span>
        </div>
        <p class="logo-subtitle">Join the developer community</p>
    </div>

    <div class="auth-card">
        <h1 class="card-title">Create your account</h1>

        <a href="{{ url_for('auth.google_login') }}" class="google-btn">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" class="google-logo">
            Sign up with Google
        </a>

        <div class="divider">
            <span class="divider-text">or register with email</span>
        </div>

        <form method="POST" action="{{ url_for('auth.register') }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="input-field">
                <label>Username</label>
                <input type="text" placeholder="@your_username" name="username" value="{{ username }}" required>
            </div>

            <div class="input-field">
                <label>Email address</label>
                <input type="email" placeholder="you@example.com" name="email" value="{{ email }}" required>
            </div>

            <div class="input-field">
                <label>Password</label>
                <input type="password" placeholder="Create a strong password" name="password" id="password" required>
                <div class="password-strength">
                    <div class="bar" id="bar-1"></div>
                    <div class="bar" id="bar-2"></div>
                    <div class="bar" id="bar-3"></div>
                    <div class="bar" id="bar-4"></div>
                </div>
                <p class="hint" id="password-hint"></p>
            </div>

            <div class="terms-row">
                <input type="checkbox" id="terms" required>
                <label for="terms">
                    I agree to the <a href="{{ url_for('main.terms') }}">Terms of Service</a> and <a href="{{ url_for('main.privacy') }}">Privacy Policy</a>
                </label>
            </div>

            <button type="submit" class="submit-btn">Create account</button>
        </form>

        <p class="footer-link">
            Already have an account? <a href="{{ url_for('auth.login') }}">Sign in</a>
        </p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const passwordInput = document.getElementById('password');
    const bars = [
        document.getElementById('bar-1'),
        document.getElementById('bar-2'),
        document.getElementById('bar-3'),
        document.getElementById('bar-4')
    ];
    const hint = document.getElementById('password-hint');

    const levels = [
        { color: '#ef4444', label: 'Weak' },
        { color: '#f97316', label: 'Fair' },
        { color: '#eab308', label: 'Good' },
        { color: '#10b981', label: 'Strong' }
    ];

    function getStrength(password) {
        let score = 0;
        if (password.length >= 8) score++;
        if (/[a-z]/.test(password) && /[A-Z]/.test(password)) score++;
        if (/\d/.test(password)) score++;
        if (/[^a-zA-Z0-9]/.test(password)) score++;
        return score;
    }

    passwordInput.addEventListener('input', () => {
        const value = passwordInput.value;
        const strength = getStrength(value);

        bars.forEach((bar, i) => {
            if (value.length === 0) {
                bar.style.background = '#27272a';
                bar.style.transition = 'background 0.3s ease';
            } else if (i < strength) {
                bar.style.background = levels[strength - 1].color;
                bar.style.transition = 'background 0.3s ease';
            } else {
                bar.style.background = '#27272a';
                bar.style.transition = 'background 0.3s ease';
            }
        });

        if (value.length === 0) {
            hint.textContent = '';
            hint.style.color = '';
        } else {
            hint.textContent = levels[strength - 1]?.label || 'Too short';
            hint.style.color = levels[strength - 1]?.color || '#71717a';
            hint.style.transition = 'color 0.3s ease';
        }
    });
});
</script>
{% endblock %}
